define(function(){function n(n){this.remaining=n,this.html=""}function t(){}function i(t,i){var s=new n(t.innerHTML);try{s.highlightJson(i)}catch(n){throw n}t.innerHTML=s.html+s.remaining}var s={},e={whitespace:/^([ \r\n\t]|&nbsp;)*/,number:/^-?[0-9]+(\.[0-9]+)?([eE][+\-]?[0-9]+)?/};n.prototype={unshift:function(n){this.remaining=n+this.remaining},next:function(){return this.whitespace(),this.nextCharacter()},nextCharacter:function(){if(0==this.remaining.length)throw new Error("Unexpected end of input");if("&"==this.remaining[0]){var n=this.remaining.indexOf(";")+1;-1==n&&(n=1);var t=this.remaining.substring(0,n);return this.remaining=this.remaining.substring(n),t}t=this.remaining[0];return this.remaining=this.remaining.substring(1),t},whitespace:function(){var n=this.remaining.match(e.whitespace)[0];this.html+=n,this.remaining=this.remaining.substring(n.length)},highlightJson:function(n){null!=n&&(this.html+=n.wrapper[0]),this.whitespace();var t=this.next();if("{"==t)this.highlightObject(n);else if("["==t)this.highlightArray(n);else if('"'==t||"&quot;"==t)this.highlightString();else if((t+this.remaining).match(e.number)){var i=(t+this.remaining).match(e.number)[0];this.html+='<span class="json-number">'+i+"</span>",this.remaining=this.remaining.substring(i.length-1)}else"n"==t&&"ull"==this.remaining.substring(0,3)?(this.remaining=this.remaining.substring(3),this.html+='<span class="json-null">null</span>'):"t"==t&&"rue"==this.remaining.substring(0,3)?(this.remaining=this.remaining.substring(3),this.html+='<span class="json-true">true</span>'):"f"==t&&"alse"==this.remaining.substring(0,4)?(this.remaining=this.remaining.substring(4),this.html+='<span class="json-false">false</span>'):(this.html+=t,this.highlightJson(n));null!=n&&(this.html+=n.wrapper[1])},highlightObject:function(n){this.html+='<span class="json-punctuation">{</span>';for(var t=this.next();"}"!=t;)if('"'==t||"&quot;"==t){var i="";for(t=this.next();'"'!=t&&"&quot"!=t;)"\\"==t&&(i+=t,t=this.nextCharacter()),i+=t,t=this.next();for(null!=n&&n.isKeyword(i)?this.html+='<span class="json-keyword">&quot;'+i+"&quot;</span>":this.html+='<span class="json-object-key">&quot;'+i+"&quot;</span>",t=this.next();":"!=t;)this.html+=t,t=this.next();this.html+='<span class="json-punctuation">:</span>';var s=null;if(null!=n&&(s=n.forKey(i)),this.highlightJson(s),t=this.next(),","==t){this.html+='<span class="json-punctuation">,</span>',t=this.next();continue}for(;"}"!=t;)this.html+=t,t=this.next()}else this.html+=t,t=this.next();this.html+='<span class="json-punctuation">}</span>'},highlightArray:function(n){this.html+='<span class="json-punctuation">[</span>';for(var t=this.next(),i=0;"]"!=t;)if(this.unshift(t),this.highlightJson(null!=n?n.forItem(i):null),t=this.next(),","!=t)for(;"]"!=t;)this.html+=t,t=this.next();else this.html+='<span class="json-punctuation">,</span>',t=this.next(),i++;this.html+='<span class="json-punctuation">]</span>'},highlightString:function(){for(this.html+='<span class="json-punctuation">&quot;</span><span class="json-string">',next=this.next();'"'!=next&&"&quot"!=next;)"\\"==next&&(this.html+=next,next=this.nextCharacter()),this.html+=next,next=this.next();this.html+='</span><span class="json-punctuation">&quot;</span>'}},t.prototype={wrapper:["<span>","</span>"],keywords:{},isKeyword:function(n){return void 0!==this.keywords[n]},forKey:function(n){return this.keywords[n]},forItem:function(n){return null}};var l=new t,h=new t,a=new t,r=new t;return l.keywords={type:null,properties:a,patternProperties:a,additionalProperties:l,items:l,additionalItems:l,required:null,dependencies:a,minimum:null,maximum:null,exclusiveMinimum:null,exclusiveMaximum:null,minItems:null,maxItems:null,uniqueItems:null,pattern:null,minLength:null,maxLength:null,enum:null,default:null,title:null,description:null,format:null,divisibleBy:null,disallow:l,extends:l,id:null,$ref:null,$schema:null,multipleOf:null,maxProperties:null,minProperties:null,allOf:l,anyOf:l,oneOf:l,not:l,definitions:a,media:h,links:r,pathStart:null,fragmentResolution:null},l.forItem=function(){return l},h.keywords={binaryEncoding:null,type:null},a.wrapper=['<span class="json-schema-map">',"</span>"],a.forKey=function(){return l},r.keywords={rel:null,href:null,method:null,encType:null,pathStart:null,schema:l,targetSchema:l},r.forItem=function(){return r},null==document.getElementsByClassName&&(document.getElementsByClassName=function(n){for(var t,i=new RegExp("(?:^|\\s)"+n+"(?:$|\\s)"),s=document.getElementsByTagName("*"),e=[],l=0;null!=(t=s[l]);l++){var h=t.className;h&&-1!=h.indexOf(n)&&i.test(h)&&e.push(t)}return e}),s.highlightSchema=function(n){i(n,l)},s});