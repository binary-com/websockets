window.Rainbow=function(){function n(n,t,e,r){var a=n.getAttribute&&n.getAttribute(t)||0;if(!a)for(e=n.attributes,r=0;r<e.length;++r)if(e[r].nodeName===t)return e[r].nodeValue;return a}function t(n,t){n.className+=n.className?" "+t:t}function e(n,t){return(" "+n.className+" ").indexOf(" "+t+" ")>-1}function r(t){var e=n(t,"data-language")||n(t.parentNode,"data-language");if(!e){var r=/\blang(?:uage)?-(\w+)/,a=t.className.match(r)||t.parentNode.className.match(r);a&&(e=a[1])}return e}function a(n){return n.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&(?![\w\#]+;)/g,"&amp;")}function o(n,t,e,r){return e>=n&&e<t||r>n&&r<t}function i(n,t,e,r){return(e!=n||r!=t)&&(e<=n&&r>=t)}function u(n,t){for(var e in L[R])if(e=parseInt(e,10),i(e,L[R][e],n,t)&&(delete L[R][e],delete y[R][e]),o(e,L[R][e],n,t))return!0;return!1}function c(n,t){return'<span class="'+n.replace(/\./g," ")+(N?" "+N:"")+'">'+t+"</span>"}function f(n,t){var e,r=0;for(e=1;e<t;++e)n[e]&&(r+=n[e].length);return r}function l(n,t,e,r){if(null==n)return r();var a=n.exec(e);if(!a)return r();++M,t.name||"string"!=typeof t.matches[0]||(t.name=t.matches[0],delete t.matches[0]);var o=a[0],i=a.index,s=a[0].length+i,g=function(){var a=function(){l(n,t,e,r)};return M%100>0?a():setTimeout(a,0)};if(u(i,s))return g();var v=function(n){t.name&&(n=c(t.name,n)),y[R]||(y[R]={},L[R]={}),y[R][i]={replace:a[0],with:n},L[R][i]=s,g()},w=d(t.matches),b=function(n,e,r){if(n>=e.length)return r(o);var i=function(){b(++n,e,r)},u=a[e[n]];if(!u)return i();var l=t.matches[e[n]],s=l.language,g=l.name&&l.matches?l.matches:l,d=function(t,r,u){o=m(f(a,e[n]),t,u?c(u,r):r,o),i()};return s?p(u,s,function(n){d(u,n)}):"string"==typeof l?d(u,u,l):void h(u,g.length?g:[g],function(n){d(u,n,l.matches?l.name:0)})};b(0,w,v)}function s(n){return H[n]}function g(n){var t=E[n]||[],e=E[C]||[];return s(n)?t:t.concat(e)}function m(n,t,e,r){var a=r.substr(n);return r.substr(0,n)+a.replace(t,e)}function d(n){var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push(e);return t.sort(function(n,t){return t-n})}function h(n,t,e){function r(t,a){if(a<t.length)return l(t[a].pattern,t[a],n,function(){r(t,++a)});v(n,function(n){delete y[R],delete L[R],--R,e(n)})}++R,r(t,0)}function v(n,t){function e(n,t,r,a){if(r<t.length){++x;var o=t[r],i=y[R][o];n=m(o,i.replace,i.with,n);var u=function(){e(n,t,++r,a)};return x%250>0?u():setTimeout(u,0)}a(n)}var r=d(y[R]);e(n,r,0,t)}function p(n,t,e){var r=g(t);h(a(n),r,e)}function w(n,a,o){if(a<n.length){var i=n[a],u=r(i);return!e(i,"rainbow")&&u?(u=u.toLowerCase(),t(i,"rainbow"),p(i.innerHTML,u,function(t){i.innerHTML=t,y={},L={},T&&T(i,u),setTimeout(function(){w(n,++a,o)},0)})):w(n,++a,o)}o&&o()}function b(n,t){n=n&&"function"==typeof n.getElementsByTagName?n:document;var e,r=n.getElementsByTagName("pre"),a=n.getElementsByTagName("code"),o=[],i=[];for(e=0;e<r.length;++e)r[e].getElementsByTagName("code").length?r[e].innerHTML=r[e].innerHTML.replace(/^\s+/,"").replace(/\s+$/,""):o.push(r[e]);for(e=0;e<a.length;++e)i.push(a[e]);w(i.concat(o),0,t)}var N,T,y={},L={},E={},H={},R=0,C=0,M=0,x=0;return{extend:function(n,t,e){1==arguments.length&&(t=n,n=C),H[n]=e,E[n]=t.concat(E[n]||[])},onHighlight:function(n){T=n},addClass:function(n){N=n},color:function(){return"string"==typeof arguments[0]?p(arguments[0],arguments[1],arguments[2]):"function"==typeof arguments[0]?b(0,arguments[0]):void b(arguments[0],arguments[1])}}}(),function(){if(document.addEventListener)return document.addEventListener("DOMContentLoaded",Rainbow.color,!1);window.attachEvent("onload",Rainbow.color)}(),Rainbow.onHighlight=Rainbow.onHighlight,Rainbow.addClass=Rainbow.addClass;